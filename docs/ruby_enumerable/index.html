<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Let's Get Enumerable</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>

  <link rel="stylesheet" href=".//css/reset.css" type="text/css"/>

  

  <link type="text/css" href=".//css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href=".//css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href=".//css/sh_style.css" rel="stylesheet" />
  <link type="text/css" href=".//css/tipsy.css" rel="stylesheet" />

  <link rel="stylesheet" href=".//css/showoff.css" type="text/css"/>

  <script type="text/javascript" src=".//js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src=".//js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src=".//js/jquery-print.js"></script>
  <script type="text/javascript" src=".//js/jquery.batchImageLoad.js"></script>
  <script type="text/javascript" src=".//js/jquery.parsequery.min.js"></script>
  <script type="text/javascript" src=".//js/jquery.doubletap-0.1.js"></script>
  <script type="text/javascript" src=".//js/jquery.tipsy.js"></script>

  <script type="text/javascript" src=".//js/fg.menu.js"></script>
  <script type="text/javascript" src=".//js/showoff.js"></script>
  <script type="text/javascript" src=".//js/jTypeWriter.js"> </script>
  <script type="text/javascript" src=".//js/sh_main.min.js"></script>
  <script type="text/javascript" src=".//js/core.js"></script>
  <script type="text/javascript" src=".//js/showoffcore.js"></script>
  <script type="text/javascript" src=".//js/coffee-script.js"></script>

  
    
      <script type="text/javascript" src=".//js/sh_lang/sh_ruby.min.js"></script>
    
      <script type="text/javascript" src=".//js/sh_lang/sh_coffeescript.min.js"></script>
    
  

  
    
    <link rel="stylesheet" href=".//file/style.css" type="text/css"/>
  

  

  <script type="text/javascript">
    $(function(){
      setupPreso(false, './');
    });

    editUrl  = "";
  </script>

</head>

<body>

<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>
<a tabindex="1" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="stylemenu"><span class="ui-icon ui-icon-triangle-1-s"></span>styles</a>
<div id="stylepicker" class="hidden"></div>


<div id="help">
  <table>
    <tr><td class="key">z, ?</td><td>toggle help (this)</td></tr>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">shift-space, &larr;</td><td>previous slide</td></tr>
    <tr><td class="key">b</td><td>blank screen</td></tr>
    <tr><td class="key">d</td><td>toggle debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c, t</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">g</td><td>toggle follow</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">n</td><td>toggle notes</td></tr>
    <tr><td class="key">p</td><td>run preshow</td></tr>
    <tr><td class="key">P</td><td>toggle pause</td></tr>
    <tr><td class="key">s</td><td>choose style</td></tr>
  </table>
</div>

<div class="buttonNav">
  <input type="submit" onClick="prevStep();" value="prev"/>
  <input type="submit" onClick="nextStep();" value="next"/>
</div>

<div id="preso"><center>loading presentation...</center></div>
<div id="footer">
  <span id="followMode"></span>
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
  <span id="slideFilename"></span>
  <img id="disconnected" src=".//css/disconnected.png" />
</div>

<div id="slides" class="offscreen" style="display:none;">
<html><body>
<div id="./01_intro" class="slide " data-transition="none">
<div class="content " ref="./01_intro/1">
<h1>McBain: Let's Get Enumerable</h1>

<h3><a class="twitter" href="https://twitter.com/kyleashipley">@kyleashipley</a></h3>
</div>
</div>
</body></html><html><body>
<div id="./01_intro" class="slide " data-transition="none">
<div class="content " ref="./01_intro/2">
<h2>Why enumerable?</h2>
</div>
</div>
</body></html><html><body>
<div id="./01_intro" class="slide code execute" data-transition="none">
<div class="content code execute" ref="./01_intro/3">
<pre class="sh_ruby"><code>def find_evens(arr)
  i = 0
  evens = []

  while i &lt; arr.length
    if arr[i] % 2 == 0
      evens &lt;&lt; arr[i]
    end

    i += 1
  end

  evens
end

find_evens([1,2,3,4,5,6,7,8])</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./01_intro" class="slide code execute" data-transition="none">
<div class="content code execute" ref="./01_intro/4">
<pre class="sh_ruby"><code>def find_evens(arr)
  evens = []

  arr.each do |num|
    evens &lt;&lt; num if num.even?
  end

  evens
end

find_evens([1,2,3,4,5,6,7,8])</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./01_intro" class="slide code execute" data-transition="none">
<div class="content code execute" ref="./01_intro/5">
<pre class="sh_ruby"><code>def find_evens(arr)
  arr.select { |num| num.even? }
end

find_evens([1,2,3,4,5,6,7,8])</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./01_intro" class="slide bullets" data-transition="none">
<div class="content bullets" ref="./01_intro/6">
<ul>
<li>More expressive (once you get used to it)</li>
<li>What, not how</li>
<li>Limit side effects</li>
</ul>
</div>
</div>
</body></html><html><body>
<div id="./01_intro" class="slide " data-transition="none">
<div class="content " ref="./01_intro/7">
<p>Mostly <strong>Arrays</strong> and <strong>Hashes</strong></p>

<p>But you can define your own.</p>
</div>
</div>
</body></html><html><body>
<div id="./01_intro" class="slide code execute" data-transition="none">
<div class="content code execute" ref="./01_intro/8">
<pre class="sh_ruby"><code>class Team
  include Enumerable

  def initialize(members)
    @members = members
  end

  def each
    @members.each { |m| yield m }
  end
end

team.each { |m| m.say_hi! }
team.sort_by { |m| m.name }
team.max { |m| m.age }</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./01_intro" class="slide " data-transition="none">
<div class="content " ref="./01_intro/9">
<p>You now have access to <strong>every</strong> method in <a href="http://ruby-doc.org/core-2.1.3/Enumerable.html">Enumerable</a>!</p>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/1">
<h2>Overview</h2>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/2">
<h3>each</h3>

<ul>
<li>each</li>
<li>each_with_index</li>
<li>enumerators</li>
</ul>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/3">
<p>each</p>

<pre class="sh_ruby"><code>(1..10).each { |i| puts i }
# will print each number to the console
# returns the original collection

%w(ant bear cat).each_with_index do |a, i|
  puts a if i.even?
end
# prints ant + cat</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/4">
<p>each (enumerator)</p>

<pre class="sh_ruby"><code>iter = (1..10).each

iter.next
=&gt; 1
# ...
iter.next
=&gt; StopIteration: iteration reached an end


%w(ant bear cat).each.with_index do |a, i|
  puts a if i.even?
end
# prints ant + cat</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/5">
<h3>Booleans</h3>

<ul>
<li>all?</li>
<li>any?</li>
<li>one?</li>
<li>none?</li>
<li>many? (Rails)</li>
<li>include?</li>
</ul>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/6">
<pre class="sh_ruby"><code>
[2, 4, 6, 8].all? { |n| n.even? }
=&gt; true

[2, 4, 6, 8].any? { |n| n.odd? }
=&gt; false

[2, 4, 6, 9].one? { |n| n.odd? }
=&gt; true

[2, 4, 6, 8].none? { |n| n.odd? }
=&gt; true</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/7">
<pre class="sh_ruby"><code>
[2, 4, 6, 8].include? 2
=&gt; true

# Rails only
[2, 4, 6, 8].many? { |n| n.even? }
=&gt; true</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/8">
<pre class="sh_ruby"><code>[2, false, 6, 8].all?
=&gt; false

[2, false, 6, 8].any?
=&gt; true

[2, false, nil, nil].one?
=&gt; true

[nil, false, 0, nil].none?
=&gt; false

[nil, false, true, 1].many?
=&gt; true</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide execute" data-transition="none">
<div class="content execute" ref="./02_overview/9">
<h3>Symbol#to_proc</h3>

<pre class="sh_ruby"><code>
# One weird trick...
# Pythonistas HATE this!

(1..10).map { |n| n.even? } ==
  (1..10).map(&amp;:even?)</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/10">
<h3>Sorting</h3>

<ul>
<li>sort</li>
<li>sort_by</li>
</ul>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/11">
<p>sort</p>

<pre class="sh_ruby"><code>[3, 1, 2, 4].sort
=&gt; [1, 2, 3, 4]

[3, 1, 2, 4].sort { |a, b| b &lt;=&gt; a }
=&gt; [4, 3, 2, 1]</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/12">
<p>sort</p>

<pre class="sh_ruby"><code>
people.sort do |p1, p2|
  if p1.name &gt; p2.name
    p1.age &lt;=&gt; p2.age
  elsif p1.name &lt; p2.name
    p1.ssn &lt;=&gt; p2.ssn
  else
    0
  end
end</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide execute" data-transition="none">
<div class="content execute" ref="./02_overview/13">
<p>sort_by</p>

<pre class="sh_ruby"><code>%w(bear pig!!! man).sort_by(&amp;:length)
=&gt; ["man", "bear", "pig!!!"]

people.sort_by { |p| [p.name, p.age] }
# careful of nil!</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/14">
<h3>Filtering + Grouping</h3>

<ul>
<li>detect / find</li>
<li>select</li>
<li>reject</li>
<li>group_by</li>
<li>partition</li>
</ul>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/15">
<p>find / detect</p>

<pre class="sh_ruby"><code>
[2, 4, 5, 6].find { |n| n.odd? }
# =&gt; 5

[1, 3, 5, 7].find { |n| n.even? }
# =&gt; nil

people.find { |p| p.name == "Waldo" }</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/16">
<p>select</p>

<pre class="sh_ruby"><code>(1..10).select(&amp;:even?)
=&gt; [2, 4, 6, 8, 10]

def bounce
  people.select { |p| p.age &gt;= 21 }
end</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/17">
<p>reject</p>

<pre class="sh_ruby"><code>(1..10).reject(&amp;:even?)
=&gt; [1, 3, 5, 7, 9]

def i_call_it_singles_city
  people.reject { |p| p.tease? }
end</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/18">
<p>group_by</p>

<pre class="sh_ruby"><code>(1..10).group_by(&amp;:even?)
=&gt; {
      false =&gt; [1, 3, 5, 7, 9],
      true =&gt; [2, 4, 6, 8, 10]
   }

people.group_by { |p| p.name[0] }
=&gt; {
     "K" =&gt; [kyle, kevin],
     "M" =&gt; [miles, matt]
   }</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/19">
<p>partition</p>

<pre class="sh_ruby"><code>(1..10).partition(&amp;:even?)
=&gt; [
     [2, 4, 6, 8, 10],
     [1, 3, 5, 7, 9]
   ]

tallies, shorties =
  people.partition { |p| p.height &gt; 6.25 }

tallies
=&gt; [kyle, kevin]

shorties
=&gt; [miles, matt]</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/20">
<h3>Transformations</h3>

<ul>
<li>map</li>
<li>inject</li>
<li>flatten / flat_map</li>
</ul>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/21">
<p>map / collect</p>

<pre class="sh_ruby"><code>(1..10).map { |n| n * 3 }
=&gt; [3, 6, 9, 12, 15, 18, 21, 24, 27, 30]

# different format for select box
people.map do |p|
  {
    id: p.id,
    value: p.name
  }
end
=&gt; [
      { id: 1, value: "Kyle" },
      { id: 2, value: "Kevin" }
   ]</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/22">
<p>inject / reduce</p>

<pre class="sh_ruby"><code>(1..10).inject(0) { |sum, n| sum + n }
=&gt; 55

# or (1..10).inject(:+)</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide small" data-transition="none">
<div class="content small" ref="./02_overview/23">
<p>inject / reduce</p>

<pre class="sh_ruby"><code># collect stats
users.inject({}) do |stats, user|
  stats[user.email] = site.visit_count_for(user)
  stats
end



# email users with a calendar event today
users.inject({}) do |events, user|
  events[user.email] = Event
    .joins(team: { memberships: :user })
    .where('start_time between ? and ?', start_time, end_time)
    .where('users.id = ?', user.id)
  events
end</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/24">
<p>flat_map</p>

<pre class="sh_ruby"><code>springfieldians.map(&amp;:kids)
=&gt; [
     ["Bart", "Lisa", "Maggie"],
     ["Rod", "Tod"],
     ["Thrillho"]
   ]

springfieldians.flat_map(&amp;:kids)
=&gt; [
     "Bart", "Lisa", "Maggie",
     "Rod", "Tod", "Thrillho"
   ]

# or map.flatten</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide execute" data-transition="none">
<div class="content execute" ref="./02_overview/25">
<p>Enumerable methods <strong>don't</strong> mutate.</p>

<pre class="sh_ruby"><code>
arr = (1..10).to_a

numsTimes3 = arr.map { |n| n * 3 }

arr


# There are bang! methods, but
# avoid them. (map!, flatten!, etc.)</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide " data-transition="none">
<div class="content " ref="./02_overview/26">
<p>Bonus: lazy!</p>

<pre class="sh_ruby"><code>
(1..Float::INFINITY)
  .map { |n| n * 3 }
  .first(10)
# infinite loop!

(1..Float::INFINITY)
  .lazy
  .map { |n| n * 3 }
  .first(10)
=&gt; [3, 6, 9, 12, 15, 18, 21, 24, 27, 30]</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide execute" data-transition="none">
<div class="content execute" ref="./02_overview/27">
<p>Bonus: lambdas!</p>

<pre class="sh_ruby"><code>under_age = -&gt;(n) { n &lt; 21 }
(1..30).reject(&amp;under_age)

# or as a method
# def under_age
#  -&gt;(n) { n &lt; 21 }
# end</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./02_overview" class="slide execute" data-transition="none">
<div class="content execute" ref="./02_overview/28">
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js"></script>

<p>Bonus: underscore.js!
(or lodash)</p>

<pre class="sh_coffeescript"><code>times3 = (n) -&gt; n * 3

result = _.map [1, 2, 3], times3
result = _([1, 2, 3]).map times3</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./03_exercises" class="slide " data-transition="none">
<div class="content " ref="./03_exercises/1">
<h2>Exercises</h2>
</div>
</div>
</body></html><html><body>
<div id="./03_exercises" class="slide " data-transition="none">
<div class="content " ref="./03_exercises/2">
<h3>1. Given a list of names, return a new list with every name shorter than 8 characters reversed and capitalized.</h3>

<pre class="sh_ruby"><code>names = [
  "Allen", "Barbara", "Christine",
  "Doug", "Elizabeth", "Frederick",
  "George"
]

rev_cap names
=&gt; ["NELLA", "ARABRAB", "GUOD", "EGROEG"]</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./03_exercises" class="slide " data-transition="none">
<div class="content " ref="./03_exercises/3">
<p>My solution:</p>

<pre class="sh_ruby"><code>def rev_cap(names)
  names
    .select { |n| n.length &lt; 8 }
    .map { |n| n.reverse.upcase }
end</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./03_exercises" class="slide " data-transition="none">
<div class="content " ref="./03_exercises/4">
<h3>2. Given a list of animals from a crappy data source, figure out how many of each kind there are.</h3>

<pre class="sh_ruby"><code>animals = [
  ["dog", "DMX"],
  ["dog", "Charles Barkley"],
  ["cat", "Whiskers"],
  ["fish", "Splashy McGee"],
  ["fish", "Swims McKenzie"]
]

count_by_type animals
=&gt; { "dog": 2, "cat": 1, "fish": 2 }</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./03_exercises" class="slide " data-transition="none">
<div class="content " ref="./03_exercises/5">
<p>My solution:</p>

<pre class="sh_ruby"><code>def count_by_type(animals)
  animals.inject(Hash.new(0)) do
    |counts, (type, _)|

    counts[type] += 1
    counts
  end
end</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./03_exercises" class="slide " data-transition="none">
<div class="content " ref="./03_exercises/6">
<p>Another solution:</p>

<pre class="sh_ruby"><code>def count_by_type(animals)
  Hash[*animals
    .group_by { |type, _| type }
    .flat_map { |type, list|
      [type, list.count]
    }
  ]
end</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./03_exercises" class="slide small" data-transition="none">
<div class="content small" ref="./03_exercises/7">
<h3>3. An item is oversized if (1) weight or dimensional weight &gt; 20, (2) the shortest dimension is greater than 8, (3) the median dimension is greater than 14, OR (4) the longest dimension is greater than 20.</h3>

<pre class="sh_ruby"><code>class Item
  MAX_WEIGHT = 20
  MAX_DIMENSIONS = [8, 14, 18]
  DIMENSIONAL_WEIGHT_FACTOR = 194

  def initialize(length, width, height, weight)
    @dimensions = [length, width, height]
    @weight = weight
  end

  def oversized?

  end

  def dimensional_weight
    @dimensions.inject(:*) / DIMENSIONAL_WEIGHT_FACTOR
  end
end</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./03_exercises" class="slide " data-transition="none">
<div class="content " ref="./03_exercises/8">
<p>My solution:</p>

<pre class="sh_ruby"><code>def oversized?
  shipping_weight &gt; MAX_WEIGHT ||
    @dimensions
      .sort
      .zip(MAX_DIMENSIONS)
      .any? { |d, max| d &gt; max }
end

def shipping_weight
  [dimensional_weight, @weight].max
end</code></pre>
</div>
</div>
</body></html><html><body>
<div id="./03_exercises" class="slide " data-transition="none">
<div class="content " ref="./03_exercises/9">
<h1>We did it!</h1>

<h3><a class="twitter" href="https://twitter.com/kyleashipley">@kyleashipley</a></h3>
</div>
</div>
</body></html></div>
<div id="pauseScreen">
  PAUSED
</div>

</body>
</html>
